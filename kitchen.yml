---
driver:
   name: openstack
   flavor_ref: m1.medium
provisioner:
  name: chef_solo
  enforce_idempotency: true
  multiple_converge: 2
  deprecations_as_errors: true
  data_bags_path: test/integration/data_bags
  encrypted_data_bag_secret_key_path: test/integration/encrypted_data_bag_secret

verifier:
  name: inspec
suites:
  - name: default
    run_list:
      - recipe[osl-acme::default]
  - name: server
    run_list:
      - recipe[osl-acme::server]
      - recipe[acme_test]
    attributes:
      osl-acme:
        pebble:
          host_aliases:
            - foo.org
  - name: acme-dns-client
    provisioner: # acme_test cookbook's execute[wait_for_acmedns] is not idempotent
      enforce_idempotency: false
      multiple_converge: 1
    run_list:
      - recipe[acme_test::acme_dns_client]
    attributes:
      osl-acme:
        acme-dns:
          ns-address: 192.168.10.1
